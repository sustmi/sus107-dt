// -*- C++ -*- generated by wxGlade HG on Tue Jan 10 21:38:21 2012

#include <wx/wx.h>
#include <wx/image.h>
#include <wx/stdpaths.h>
#include "ui/EmulatorView.h"


class Application: public wxApp {
public:
	bool OnInit();
};

IMPLEMENT_APP(Application)



void InitLanguageSupport()
{
	wxLocale* locale;
    long language = wxLANGUAGE_DEFAULT;

	// load language if possible, fall back to english otherwise
	if(wxLocale::IsAvailable(language)) {
		locale = new wxLocale( language, wxLOCALE_CONV_ENCODING );

		locale->AddCatalogLookupPathPrefix(wxT("lang"));
#ifdef __WXGTK__
		// add locale search paths
		locale->AddCatalogLookupPathPrefix(wxT("/usr"));
		locale->AddCatalogLookupPathPrefix(wxT("/usr/local"));
		wxStandardPaths* paths = (wxStandardPaths*) &wxStandardPaths::Get();
		wxString prefix = paths->GetInstallPrefix();
		locale->AddCatalogLookupPathPrefix( prefix );
#endif

		locale->AddCatalog(wxT("sus107-dt"));

		if(! locale->IsOk() ) {
			std::cerr << "selected language is wrong" << std::endl;
			delete locale;
			locale = new wxLocale( wxLANGUAGE_ENGLISH );
			language = wxLANGUAGE_ENGLISH;
		}
	} else {
		std::cout << "The selected language is not supported by your system."
		<< "Try installing support for this language." << std::endl;
		locale = new wxLocale( wxLANGUAGE_ENGLISH );
		language = wxLANGUAGE_ENGLISH;
	}

}

bool Application::OnInit()
{
	wxInitAllImageHandlers();
	InitLanguageSupport();
	EmulatorView* emulator_view = new EmulatorView(NULL, wxID_ANY, wxEmptyString);
	emulator_view->init();
	SetTopWindow(emulator_view);
	emulator_view->Show();
	return true;
}
